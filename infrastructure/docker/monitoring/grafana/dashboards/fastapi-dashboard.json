{
  "title": "FastAPI Application Metrics",
  "tags": [
    "fastapi",
    "http",
    "api"
  ],
  "timezone": "browser",
  "schemaVersion": 27,
  "version": 1,
  "refresh": "10s",
  "panels": [
    {
      "id": 1,
      "title": "HTTP Request Rate",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 0
      },
      "targets": [
        {
          "expr": "sum(rate(http_requests_total{app=\"financial-data-extractor-api\"}[5m])) by (method, status)",
          "legendFormat": "{{method}} {{status}}",
          "refId": "A"
        }
      ],
      "yaxes": [
        {
          "format": "reqps",
          "label": "Requests/sec"
        },
        {
          "format": "short"
        }
      ],
      "xaxis": {
        "mode": "time"
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      }
    },
    {
      "id": 2,
      "title": "HTTP Request Duration (p50, p95, p99)",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 0
      },
      "targets": [
        {
          "expr": "histogram_quantile(0.50, sum(rate(http_request_duration_seconds_bucket{app=\"financial-data-extractor-api\"}[5m])) by (le, method, endpoint))",
          "legendFormat": "p50 {{method}} {{endpoint}}",
          "refId": "A"
        },
        {
          "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{app=\"financial-data-extractor-api\"}[5m])) by (le, method, endpoint))",
          "legendFormat": "p95 {{method}} {{endpoint}}",
          "refId": "B"
        },
        {
          "expr": "histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{app=\"financial-data-extractor-api\"}[5m])) by (le, method, endpoint))",
          "legendFormat": "p99 {{method}} {{endpoint}}",
          "refId": "C"
        }
      ],
      "yaxes": [
        {
          "format": "s",
          "label": "Duration"
        },
        {
          "format": "short"
        }
      ],
      "xaxis": {
        "mode": "time"
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      }
    },
    {
      "id": 3,
      "title": "HTTP Error Rate",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 8
      },
      "targets": [
        {
          "expr": "sum(rate(http_requests_total{app=\"financial-data-extractor-api\", status=~\"5..\"}[5m])) by (method, endpoint)",
          "legendFormat": "{{method}} {{endpoint}}",
          "refId": "A"
        }
      ],
      "yaxes": [
        {
          "format": "reqps",
          "label": "Errors/sec"
        },
        {
          "format": "short"
        }
      ],
      "xaxis": {
        "mode": "time"
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      }
    },
    {
      "id": 4,
      "title": "Request/Response Body Sizes",
      "type": "graph",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 8
      },
      "targets": [
        {
          "expr": "avg(http_request_body_size_bytes{app=\"financial-data-extractor-api\"}) by (method, endpoint)",
          "legendFormat": "Request {{method}} {{endpoint}}",
          "refId": "A"
        },
        {
          "expr": "avg(http_response_body_size_bytes{app=\"financial-data-extractor-api\"}) by (method, endpoint)",
          "legendFormat": "Response {{method}} {{endpoint}}",
          "refId": "B"
        }
      ],
      "yaxes": [
        {
          "format": "bytes",
          "label": "Size"
        },
        {
          "format": "short"
        }
      ],
      "xaxis": {
        "mode": "time"
      },
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      }
    },
    {
      "id": 5,
      "title": "HTTP Status Codes Distribution",
      "type": "piechart",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 16
      },
      "targets": [
        {
          "expr": "sum(http_requests_total{app=\"financial-data-extractor-api\"}) by (status)",
          "legendFormat": "{{status}}",
          "refId": "A"
        }
      ],
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      }
    },
    {
      "id": 6,
      "title": "Top Endpoints by Request Count",
      "type": "table",
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 16
      },
      "targets": [
        {
          "expr": "topk(10, sum(http_requests_total{app=\"financial-data-extractor-api\"}) by (endpoint, method))",
          "format": "table",
          "instant": true,
          "refId": "A"
        }
      ],
      "datasource": {
        "type": "prometheus",
        "uid": "prometheus"
      }
    }
  ],
  "id": null,
  "uid": "fastapi-dashboard",
  "editable": true
}
